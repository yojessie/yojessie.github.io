---
title: "[JS] async / await ê°œë…ì •ë¦¬"
excerpt: "awaitê³¼ asyncëŠ” promiseë¥¼ ë” ê¹”ë”í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ë‹¤."

categories:
  - Javascript
tags:
  - Javascript
  - promise
  - await
  - async

date: 2022-05-14
last_modified_at: 2022-09-20
---

<br>
<br>

[ì´ê³ ì‰ë‹˜ ê°•ì˜]ë¥¼ ë“£ê³  ì •ë¦¬í–ˆë‹¤.

<br>
<br>

## await & async

promiseê°€ ì½œë°±ì§€ì˜¥ì„ ë¬´ì°Œë¥¼ ìˆ˜ ìˆëŠ” ì¢‹ì€ ë°©ë²•ì´ì§€ë§Œ<br>
ê·¸ë˜ë„ ì½”ë“œê°€ ë³µì¡í•˜ê¸°ëŠ” í•˜ë‹¤.

ê·¸ë˜ì„œ ES8 ë¬¸ë²•ìœ¼ë¡œ `await` ê³¼ `async` ê°€ ì¶”ê°€ë˜ì—ˆë‹¤.<br>
`await` ê³¼ `async` ëŠ” `promise`ë¥¼ ë” ê¹”ë”í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ë‹¤.<br>
í•˜ì§€ë§Œ ê²½ìš°ì— ë”°ë¼ ë” ì¢‹ì€ ë°©ë²•ë“¤ì´ ë‹¤ë¥´ê¸°ë•Œë¬¸ì—, ì ì ˆíˆ ì„ì–´ì„œ í™œìš©í•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤.

<br>
<br>

## promise ë³µìŠµì„ ë¨¼ì € í•´ë³´ì

1ì´ˆ í›„ í…ìŠ¤íŠ¸ ì¶œë ¥, ë‹¤ì‹œ 2ì´ˆí›„ í…ìŠ¤íŠ¸ ì¶œë ¥, ë‹¤ì‹œ 3ì´ˆí›„ í…ìŠ¤íŠ¸ë¥¼ ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜ê°€ ìˆë‹¤.

```javascript
function timer(time) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      resolve(time);
    }, time);
  });
}

console.log("start"); // ì‘ì—…ì˜ ì‹œì‘ì„ ì•Œë¦¬ëŠ” í…ìŠ¤íŠ¸ ì¶œë ¥
timer(1000)
  .then((result) => {
    console.log(result);
    return timer(result + 1000);
  })
  .then((result) => {
    console.log(result);
    return timer(result + 1000);
  })
  .then((result) => {
    console.log(result); // promise chainìœ¼ë¡œ ì‘ì—…ì„ ì—°ê²°
    console.log("end"); // ì‘ì—…ì˜ ëì„ ì•Œë¦¬ëŠ” í…ìŠ¤íŠ¸ ì¶œë ¥ ì½”ë“œë¥¼ ë¹„ë™ê¸°ì²˜ë¦¬
  });
```

![img01](https://user-images.githubusercontent.com/81657811/191149879-eff0b77d-fafd-44b7-9c8e-99220af2276b.png)

promiseë¥¼ ì´ìš©í•´ì„œ ì½œë°±ì§€ì˜¥ì„ íƒˆì¶œí–ˆë‹¤.<br>
promise chainì„ í†µí•´ ì—¬ëŸ¬ ì‘ì—…ë“¤ì„ ë³‘ë ¬ë¡œ ì˜ ì •ë¦¬í–ˆì§€ë§Œ,<br>
ì•„ì§ë„ ì´ ì½”ë“œê°€ ë³µì¡í•´ë³´ì˜€ë˜ ìŠ¨ìƒë‹˜ë“¤ì€ ë” ì¢‹ì€ ê²ƒì„ ë§Œë“¤ì–´ë‚´ì…¨ë‹¤.

<br>
<br>

## await, asyncë¥¼ ì‚¬ìš©í•´ ë‹¤ì‹œ ì •ë¦¬í•´ë³´ì

awaitëŠ” promiseë¥¼ ì‹¤í–‰í•˜ëŠ” ì½”ë“œë¥¼ ë§ˆì¹˜ ë™ê¸°ì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ì½”ë“œì²˜ëŸ¼<br>
ê¹”ë”í•˜ê²Œ ìˆœì„œëŒ€ë¡œ ì ì„ ìˆ˜ ìˆê²Œ í•˜ëŠ” syntactic sugar ì´ë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œëŠ” promise í•¨ìˆ˜ë¥¼ ì‚¬ìš©í• ë•Œ, ì•ì— awaitë¥¼ ë¶™ì´ë©´ ëœë‹¤.

```javascript
await timer(1000);
```

ì´ë ‡ê²Œ ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜ëŠ” ê²°êµ­ promiseì—ì„œ resolveì— ì •ì˜ë˜ì–´ìˆëŠ” ë¦¬í„´ê°’ì„ ë°›ì•„ ì˜¤ëŠ”ë°,<br>
ê·¸ê°’ì„ ë³€ìˆ˜ì— ì €ì¥í•´ì„œ ë‹¤ìŒ ì‘ì—…ì— ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```javascript
let result = await timer(1000);
console.log(result);
```

<br>

í•˜ì§€ë§Œ ì´ë ‡ê²Œ ë°”ê¿” ì‹¤í–‰í•˜ë©´<br>
'awaitëŠ” async í•¨ìˆ˜ ì•ˆì—ì„œë§Œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤'ëŠ” ì—ëŸ¬ ë¬¸êµ¬ê°€ ëœ¬ë‹¤.

ê·¸ë˜ì„œ awaitë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì´ë ‡ê²Œ ë°”ê¿”ì¤˜ì•¼í•œë‹¤.

```javascript
async function run() {
  let result = await timer(1000);
  console.log(result);
}
run();
```

async ê°€ ì•ì— ë¶™ì€ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ ì½”ë“œë¥¼ ì•ˆì— ë„£ê³ , ì‹¤í–‰ì‹œì¼°ë‹¤.

<br>

ê·¸ë˜ì„œ ìœ„ì— thenìœ¼ë¡œ ë³‘ë ¬ ì •ë¦¬í–ˆë˜ ì½”ë“œë¥¼ ë‹¤ì‹œ í•œë²ˆ awaitë¥¼ ì‚¬ìš©í•´ ë°”ê¿” ë³¼ ìˆ˜ ìˆë‹¤.

```javascript
async function run() {
  console.log("start");
  let result = await timer(1000);
  console.log(result);
  result = await timer(result + 1000);
  console.log(result);
  result = await timer(result + 1000);
  console.log(result);
  console.log("end");
}
run();
```

![img01](https://user-images.githubusercontent.com/81657811/191149879-eff0b77d-fafd-44b7-9c8e-99220af2276b.png)
_ìœ„ then ë©”ì†Œë“œë¥¼ í™œìš©í•œ ê²ƒê³¼ ë™ì¼í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤._

<br>
<br>

## ë¹„ë™ê¸°ì²˜ë¦¬ê°€ í•œë²ˆ ë” í•„ìš”í•˜ë‹¤ë©´?

async í•¨ìˆ˜ë¥¼ ì‹¤í–‰í–ˆëŠ”ë°, ë˜ ì• ë’¤ë¡œ ì‹œì‘ê³¼ ëì„ ì•Œë¦¬ëŠ” ë©”ì„¸ì§€ê°€ ì¶œë ¥ë˜ê²Œ í•˜ë ¤ë©´?

```javascript
console.log("parent start");
run();
console.log("parent end");
```

![img03](https://user-images.githubusercontent.com/81657811/191190758-90432f38-f5a7-4809-9ac6-a426daf983e0.png)

`console.log('parent end')` ëŠ” ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸°ì½”ë“œ(setTimeout)ê°€ ì‹¤í–‰ë˜ê¸° ì „ì— ë¨¼ì € ì‹¤í–‰ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

<br>

ê·¸ë ‡ë‹¤ë©´ ì´ ì½”ë“œë“¤ì´ ë¹„ë™ê¸°ì²˜ë¦¬ ë  ìˆ˜ ìˆë„ë¡ ë‹¤ì‹œí•œë²ˆ await ì‹œì¼œì¤„ ìˆ˜ ìˆë‹¤.

```javascript
async function run2() {
  console.log("parent start");
  await run();
  console.log("parent end");
}

run2();
```

![img04](https://user-images.githubusercontent.com/81657811/191190960-52567647-a87f-4152-ba81-78e34704d320.png)

<br>

ğŸ’¡<br>
ì—¬ê¸°ì„œ run í•¨ìˆ˜ì— await ì²˜ë¦¬ê°€ ê°€ëŠ¥í•œ ì´ìœ ë¥¼ ì§šê³ ê°€ì•¼í•œë‹¤.<br>
`console.log(run())`ìœ¼ë¡œ run í•¨ìˆ˜ë¥¼ ì¶œë ¥í•´ë³´ë©´

![img05](https://user-images.githubusercontent.com/81657811/191190963-734289ab-f6e1-41b5-998c-29716a4e5963.png)

ì´ë ‡ê²Œ promise í•¨ìˆ˜ê°€ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤.<br>
async í•¨ìˆ˜ëŠ” ë˜ ë‹¤ì‹œ promise í•¨ìˆ˜ë¥¼ ë¦¬í„´í•˜ëŠ” ê²ƒì´ë‹¤.

ì´ê²ƒì´ run()ì—ë„ ë‹¤ì‹œ awiatë¥¼ ë¶™ì´ê³ , ê·¸ê²ƒì„ ë‹¤ì‹œ async í•¨ìˆ˜ì— ë„£ëŠ” ì‘ì—…ì´ ê°€ëŠ¥í•œ ì´ìœ ì´ë‹¤.

[ì´ê³ ì‰ë‹˜ ê°•ì˜]: https://youtu.be/1z5bU-CTVsQ
